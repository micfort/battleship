cmake_minimum_required(VERSION 2.6)
project(battleship)

set(VERSION_MAJOR 0)
set(VERSION_MINOR 0)
set(VERSION_PATCH 10)

set(VERSION ${VERSION_MAJOR}.${VERSION_MINOR}.${VERSION_PATCH})

configure_file(${CMAKE_CURRENT_SOURCE_DIR}/rename_exe.sh.in
    ${CMAKE_CURRENT_BINARY_DIR}/rename_exe.sh)

IF (POLICY CMP0017)
    cmake_policy(SET CMP0017 NEW)
ENDIF (POLICY CMP0017)

include_directories(src/bot)
include_directories(src/model)
include_directories(src/util)
include_directories(src/controller)
include_directories(src/desk_functions)
include_directories(src/view)
include_directories(src)

include_directories("${PROJECT_SOURCE_DIR}/src/view"
    "${PROJECT_BINARY_DIR}/src/view"
    "${PROJECT_BINARY_DIR}")

FIND_PACKAGE(Qt4 REQUIRED)
INCLUDE(${QT_USE_FILE})

file(GLOB sources "src/model/*.cpp" "src/bot/*.cpp"
    "src/util/*.cpp" "src/controller/*.cpp"
    "src/desk_functions/*.cpp" "src/view/*.cpp" "src/*.cpp")
file(GLOB uis "src/view/*.ui")
file(GLOB qheaders "src/view/*.hpp")

QT4_WRAP_UI(UISrcs ${uis})
QT4_WRAP_CPP(MOCrcs ${qheaders})
QT4_ADD_RESOURCES(RCSrcs "src/view/qbattleship.qrc")

add_executable(battleship ${sources} ${MOCrcs} ${UISrcs}
    ${RCSrcs})
TARGET_LINK_LIBRARIES(battleship ${QT_LIBRARIES})

IF (MINGW)
    SET(CMAKE_EXE_LINKER_FLAGS -mwindows)
ENDIF (MINGW)
